import requests
import os

def printAscii():
    print(r"   _____    __________________.___  _________ _______  .__________________________________  ")
    print(r"  /  _  \   \      \__    ___/|   |/   _____/ \      \ |   \______   \_   _____/\______   \ ")
    print(r" /  /_\  \  /   |   \|    |   |   |\_____  \  /   |   \|   ||     ___/|    __)_  |       _/ ")
    print(r"/    |    \/    |    \    |   |   |/        \/    |    \   ||    |    |        \ |    |   \ ")
    print(r"\____|__  /\____|__  /____|   |___/_______  /\____|__  /___||____|   /_______  / |____|_  / ")
    print(r"        \/         \/                     \/         \/                      \/         \/  ")


def startup():
    os.system('title Antisniper Announce')
    os.system('color b')
    if os.name == 'nt':
        os.system('cls')
    else:
        os.system('clear')
startup()




webhook_url = 'https://discord.com/api/webhooks/1237295124669792257/FoQ70msFPKfQJtiM5s-oq1TTDw-5U3bRHmaO0BTSCGuMkJXfZeZ4iXai9b8Fd708zoiS'

def snipeinfo():
    name = input("Enter Sniped IGN : ")
    serverip = input("Enter Server Name : ")
    return name, serverip

def send_message(webhook_url, name, serverip):
    if serverip == 'pika':
        sip = 'play.pika-network.net - Pika Network'
    elif serverip == 'jartex':
        sip = 'play.jartex-network.net - Jartex Network'
    elif serverip == 'blocksmc':
        sip = 'Blocksmc.com - BlocksMC'
    else:
        sip = 'Unknown Server'
        
    message = f"<@&1237306767239548961> :regional_indicator_l: Sniped : {name} - Server : {sip} :small_red_triangle_down:"
    data = {
        "content": message
    }
    requests.post(webhook_url, json=data)

def send_message2(webhook_url, name, serverip):
    if serverip == 'pika':
        sip = 'play.pika-network.net - Pika Network'
    elif serverip == 'jartex':
        sip = 'play.jartex-network.net - Jartex Network'
    elif serverip == 'blocksmc':
        sip = 'Blocksmc.com - BlocksMC'
    else:
        sip = 'Unknown Server'
        
    message = f"<@&1237306767239548961> :large_blue_diamond: Lose : {name} - Server : {sip} :small_red_triangle_down:"
    data = {
        "content": message
    }
    requests.post(webhook_url, json=data)

def clscr():
    if os.name == 'nt':
        os.system('cls')
    else:
        os.system('clear')

def main():
    while True:
        printAscii()
        print('snipe. Announce Success Sniping')
        print('lose. Announce Lose Sniping')
        print('reload. To Reload Console')
        sect = input(">")
        
        if sect == 'snipe':
            name, serverip = snipeinfo()
            send_message(webhook_url, name, serverip)
            clscr()
        elif sect == 'lose':
            name, serverip = snipeinfo()
            send_message2(webhook_url, name, serverip)
            clscr()
        elif sect == 'reload':
            os.system('cls')
            main()  # Restart the main loop
        elif sect == 'quit':
            break
        else:
            print("Invalid input. Please enter 'snipe', 'lose', 'reload', or 'quit'.")
            clscr()


if __name__ == "__main__":
    main()
